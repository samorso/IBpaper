<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Logistic regression • IBpaper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Logistic regression">
<meta property="og:description" content="IBpaper">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">IBpaper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/betareg.html">Beta regression</a>
    </li>
    <li>
      <a href="../articles/logistic.html">Logistic regression</a>
    </li>
    <li>
      <a href="../articles/negbin.html">Negative binomial regression</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/samorso/IBpaper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="logistic_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Logistic regression</h1>
            
            <h4 data-toc-skip class="date">2022-04-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/samorso/IBpaper/blob/HEAD/vignettes/logistic.Rmd" class="external-link"><code>vignettes/logistic.Rmd</code></a></small>
      <div class="hidden name"><code>logistic.Rmd</code></div>

    </div>

    
    
<p>We present how to perform the simulation studies in <span class="citation">Guerrier et al. (2020)</span> for logistic regression. We warn the reader that the code presented here may take a very long time to run on their personal computer. Indeed, for the paper, the computations were performed at University of Geneva on “Baobab” and “Yggdrasil” HPC clusters. We present the regular logistic regression and the logistic regression with misclassification.</p>
<div class="section level2">
<h2 id="setting">Setting<a class="anchor" aria-label="anchor" href="#setting"></a>
</h2>
<p>Some of the setting’s parameters are common to both situations.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/samorso/IBpaper" class="external-link">IBpaper</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SMAC-Group/ib/" class="external-link">ib</a></span><span class="op">)</span>

<span class="co"># simulation specifics</span>
<span class="va">MC</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># number of simulations</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span> <span class="co"># sample size</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">200</span> <span class="co"># number of coefficients</span>
<span class="co"># Non-zero coefficients:</span>
<span class="co"># intercept is 1</span>
<span class="va">beta_nz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Coefficients:</span>
<span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">beta_nz</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">p</span><span class="op">-</span><span class="fl">15</span><span class="op">)</span><span class="op">)</span>

<span class="co"># seeds for random number generator</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">895724</span><span class="op">)</span>
<span class="va">seed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">seed</span><span class="op">$</span><span class="va">process</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">1e7</span>,<span class="va">MC</span><span class="op">)</span> <span class="co"># for the response</span>
<span class="va">seed</span><span class="op">$</span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">1e7</span>,<span class="va">MC</span><span class="op">)</span> <span class="co"># for the design</span>
<span class="va">seed</span><span class="op">$</span><span class="va">ib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">1e7</span>,<span class="va">MC</span><span class="op">)</span> <span class="co"># for the iterative bootstrap</span>

<span class="co"># IB specifics</span>
<span class="va">H</span> <span class="op">&lt;-</span> <span class="fl">200</span> <span class="co"># number of simulated estimators</span>
<span class="va">bbc_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ib/man/ibControl.html" class="external-link">ibControl</a></span><span class="op">(</span>H<span class="op">=</span><span class="va">H</span>, maxit<span class="op">=</span><span class="fl">1L</span><span class="op">)</span> <span class="co"># control for bootstrap bias correction (BBC)</span>
<span class="va">ib_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ib/man/ibControl.html" class="external-link">ibControl</a></span><span class="op">(</span>H<span class="op">=</span><span class="va">H</span>, maxit<span class="op">=</span><span class="fl">50L</span><span class="op">)</span> <span class="co"># control for iterative bootstrap (IB)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="regular-logistic-regression">Regular logistic regression<a class="anchor" aria-label="anchor" href="#regular-logistic-regression"></a>
</h2>
<p>Here is the code for the simulation of logistic regression:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># For saving the results</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="va">p</span><span class="op">+</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">MC</span><span class="op">)</span>,
            bbc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="va">p</span><span class="op">+</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">MC</span><span class="op">)</span>,
            jini <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="va">p</span><span class="op">+</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">MC</span><span class="op">)</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">m</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">MC</span><span class="op">)</span><span class="op">{</span>
  <span class="co">##------- simulate the process ---------</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">$</span><span class="va">process</span><span class="op">[</span><span class="va">m</span><span class="op">]</span><span class="op">)</span> <span class="co"># set the seed</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span>,sd<span class="op">=</span><span class="va">p</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span><span class="op">)</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="co"># simulate the design</span>
  <span class="va">logistic_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_logistic.html">make_logistic</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">beta</span><span class="op">)</span> <span class="co"># see ?make_logistic</span>
  <span class="co"># simulate logistic responses</span>
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ib/man/simulation.html" class="external-link">simulation</a></span><span class="op">(</span><span class="va">logistic_object</span>, 
                  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>seed<span class="op">=</span><span class="va">seed</span><span class="op">$</span><span class="va">process</span><span class="op">[</span><span class="va">m</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> 
  
  <span class="co">##------ MLE estimation ----------------</span>
  <span class="co"># Note: here the MLE is the initial estimator</span>
  <span class="va">fit_mle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">"logit"</span><span class="op">)</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.control.html" class="external-link">glm.control</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span>
  <span class="va">res</span><span class="op">$</span><span class="va">mle</span><span class="op">[</span><span class="va">m</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_mle</span><span class="op">)</span>
  
  <span class="co">##------ Bootstrap bias correction -----</span>
  <span class="va">bbc_control</span><span class="op">$</span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="va">seed</span><span class="op">$</span><span class="va">ib</span><span class="op">[</span><span class="va">m</span><span class="op">]</span> <span class="co"># update the seed</span>
  <span class="va">fit_bbc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ib/man/ib.html" class="external-link">ib</a></span><span class="op">(</span><span class="va">fit_mle</span>, control <span class="op">=</span> <span class="va">bbc_control</span><span class="op">)</span> <span class="co"># compute BBC</span>
  <span class="va">res</span><span class="op">$</span><span class="va">bbc</span><span class="op">[</span><span class="va">m</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ib/man/getEst.html" class="external-link">getEst</a></span><span class="op">(</span><span class="va">fit_bbc</span><span class="op">)</span> <span class="co"># retrieve estimator</span>
  
  <span class="co">##------ IB bias correction ------------</span>
  <span class="va">ib_control</span><span class="op">$</span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="va">seed</span><span class="op">$</span><span class="va">ib</span><span class="op">[</span><span class="va">m</span><span class="op">]</span> <span class="co"># update the seed</span>
  <span class="va">fit_jini</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ib/man/ib.html" class="external-link">ib</a></span><span class="op">(</span><span class="va">fit_mle</span>, control <span class="op">=</span> <span class="va">ib_control</span><span class="op">)</span> <span class="co"># compute IB</span>
  <span class="va">res</span><span class="op">$</span><span class="va">jini</span><span class="op">[</span><span class="va">m</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ib/man/getEst.html" class="external-link">getEst</a></span><span class="op">(</span><span class="va">fit_jini</span><span class="op">)</span> <span class="co"># retrieve estimator</span>
  <span class="co"># getIteration(fit_jini), if one wants to retrieve the number of iterations</span>

  <span class="co"># print the iteration</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">m</span>,<span class="st">"\n"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="logistic-regression-with-misclassified-responses">Logistic regression with misclassified responses<a class="anchor" aria-label="anchor" href="#logistic-regression-with-misclassified-responses"></a>
</h2>
<p>We need first to consider the “misclassification process”. For that, we need to specify how to generate misclassified responses:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Random misclassification:</span>
<span class="co"># False Positive (FP) follows rbeta(1.5,50)</span>
<span class="co"># False Negative (FN) follows rbeta(1.1,10)</span>
<span class="va">fp</span> <span class="op">&lt;-</span> <span class="fl">1.5</span> <span class="op">/</span> <span class="fl">51.5</span> <span class="co"># mean FP</span>
<span class="va">fn</span> <span class="op">&lt;-</span> <span class="fl">1.1</span> <span class="op">/</span> <span class="fl">21.1</span> <span class="co"># mean FN</span>

<span class="co"># Function to simulate responses with random misclassification</span>
<span class="co"># see ?ib::simulation and ?ib::control for more details </span>
<span class="va">random_misclassification</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">control</span>, <span class="va">extra</span><span class="op">)</span><span class="op">{</span>
  <span class="va">ftd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ftd</span><span class="op">)</span>
  <span class="va">N</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">*</span> <span class="va">control</span><span class="op">$</span><span class="va">H</span>
  <span class="va">u1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">N</span>, shape1 <span class="op">=</span> <span class="fl">1.5</span>, shape2 <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
  <span class="va">u2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">N</span>, shape1 <span class="op">=</span> <span class="fl">1.1</span>, shape2 <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
  <span class="va">mu_star</span> <span class="op">&lt;-</span> <span class="va">u1</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">ftd</span>,<span class="va">control</span><span class="op">$</span><span class="va">H</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">u2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">ftd</span>,<span class="va">control</span><span class="op">$</span><span class="va">H</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">mu_star</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, ncol<span class="op">=</span><span class="va">control</span><span class="op">$</span><span class="va">H</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">ib_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ib/man/ibControl.html" class="external-link">ibControl</a></span><span class="op">(</span>H <span class="op">=</span> <span class="va">H</span>, maxit <span class="op">=</span> <span class="fl">50L</span>, sim <span class="op">=</span> <span class="va">random_misclassification</span><span class="op">)</span> <span class="co"># control for iterative bootstrap (IB)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># For saving the results</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="va">p</span><span class="op">+</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">MC</span><span class="op">)</span>,
            initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="va">p</span><span class="op">+</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">MC</span><span class="op">)</span>,
            jini <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="va">p</span><span class="op">+</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">MC</span><span class="op">)</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">m</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">MC</span><span class="op">)</span><span class="op">{</span>
  <span class="co">##------- simulate the process ---------</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">$</span><span class="va">process</span><span class="op">[</span><span class="va">m</span><span class="op">]</span><span class="op">)</span> <span class="co"># set the seed</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span>,sd<span class="op">=</span><span class="va">p</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span><span class="op">)</span><span class="op">)</span>, nr<span class="op">=</span><span class="va">n</span><span class="op">)</span> <span class="co"># simulate the design</span>
  <span class="va">logistic_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_logistic.html">make_logistic</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">beta</span><span class="op">)</span> <span class="co"># see ?make_logistic</span>
  <span class="co"># simulate logistic with misclassified responses</span>
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ib/man/simulation.html" class="external-link">simulation</a></span><span class="op">(</span><span class="va">logistic_object</span>, 
                  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>seed<span class="op">=</span><span class="va">seed</span><span class="op">$</span><span class="va">process</span><span class="op">[</span><span class="va">m</span><span class="op">]</span>, sim<span class="op">=</span><span class="va">random_misclassification</span><span class="op">)</span><span class="op">)</span> 
  
  <span class="co">##------ MLE estimation ----------------</span>
  <span class="va">fit_mle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logistic_misclassification_mle.html">logistic_misclassification_mle</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">fp</span>,<span class="va">fn</span><span class="op">)</span> <span class="co"># see ?logistic_misclassification_mle</span>
  <span class="va">res</span><span class="op">$</span><span class="va">mle</span><span class="op">[</span><span class="va">m</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit_mle</span>
  
  <span class="co">##------ Initial estimator (inconsistent) ----------------</span>
  <span class="va">fit_initial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">"logit"</span><span class="op">)</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.control.html" class="external-link">glm.control</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span>
  <span class="va">res</span><span class="op">$</span><span class="va">initial</span><span class="op">[</span><span class="va">m</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_mle</span><span class="op">)</span>
  
  <span class="co">##------ IB bias correction ------------</span>
  <span class="va">ib_control</span><span class="op">$</span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="va">seed</span><span class="op">$</span><span class="va">ib</span><span class="op">[</span><span class="va">m</span><span class="op">]</span> <span class="co"># update the seed</span>
  <span class="va">fit_jini</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ib/man/ib.html" class="external-link">ib</a></span><span class="op">(</span><span class="va">fit_initial</span>, control <span class="op">=</span> <span class="va">ib_control</span><span class="op">)</span> <span class="co"># compute IB, see ? ib::ib for more details</span>
  <span class="va">res</span><span class="op">$</span><span class="va">jini</span><span class="op">[</span><span class="va">m</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ib/man/getEst.html" class="external-link">getEst</a></span><span class="op">(</span><span class="va">fit_jini</span><span class="op">)</span> <span class="co"># retrieve estimator</span>
  <span class="co"># getIteration(fit_jini), if one wants to retrieve the number of iterations</span>

  <span class="co"># print the iteration</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">m</span>,<span class="st">"\n"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-guerrier2020general">
<p>Guerrier, Stéphane, Mucyo Karemera, Samuel Orso, Maria-Pia Victoria-Feser, and Yuming Zhang. 2020. “A General Approach for Simulation-Based Bias Correction in High Dimensional Settings.” <a href="https://arxiv.org/pdf/2010.13687.pdf" class="external-link">https://arxiv.org/pdf/2010.13687.pdf</a>. <a href="https://arxiv.org/pdf/2010.13687.pdf" class="external-link">https://arxiv.org/pdf/2010.13687.pdf</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samuel Orso.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
